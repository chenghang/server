#日志类实现
	参考muduo库实现一个多线程异步日志。
	在服务端编程中，日志是必不可少的，在生产环境中应该做到"Log Everything All The Time"。对于关键进程日志通常要记录：
	1）收到的每条内部消息的ID（还可以包括关键字段、长度、hash等）；
	2）收到的每条外部消息的全文；
	3）发出的每条消息的全文，每条消息都有全局唯一的ID；
	4）关键内部状态的变更。
    每条日志都有时间戳，这样才能完整追踪分布式系统中的一个事件的来龙去脉。一个日志库大体可以分为前端和后端两部分。前端是供应用程序使用的接口，并生成日志消息。后端负责把应用消息写到目的地。在多线程程序中前端和后端都与单线程程序没啥区别，无非是每个线程有自己的前端，整个程序共用一个后端。难点在于将日志文件从多个前端高效的传输到后端。这是一个典型的多生产者-单消费者问题，对消费者（后端）而言，要做到足够大的吞吐量并占用较少资源。
	对于c++程序而言，最好整个程序都是用相同的日志库，程序有一个整体的日志输出，而不要各个组件有自己的日志输出。从这个意义上讲日志库是一个singleton。
    日志库采用c++stream风格，这样用起来更自然，不必费心保持格式字符串与参数类型的一致性可以随用随写，而且是类型安全的。日志库并没用使用标准库中的iostream，而是自己写的LogStream Class，这主要是出于性能原因。
	多线程程序对日志库提出了新的要求，线程安全，即多个线程可以并发写日志，两个现成的日志消息不会出现交织。线程安全不难办到，简单的方法就是用一个全局mutex保护I/O，或者每一个线程单独写一个日志文件，但上述两种做法效果堪忧，前者可能造成全部线程抢一个锁，后者可能让业务线程阻塞在写磁盘操作上。多线程程序中多个线程程最好只写一个日志文件，这样分析日志更容易，不必在多个文件中跳来跳去。用一个背景线程负责收集日志消息，并写入日志文件，其他业务线程只管往这个"日志线程"发送日志消息，这称为"异步日志"。在多线程程序中异步日志是必须的，如果由业务线程直接往磁盘写数据的话，写操作往往可能会阻塞数秒之久。我们需要一个"队列"来将日志前端的数据传送到后端，但这个"队列"不必是现成的，不用每次收到一条日志消息都通知接收方。
	日志库采用双缓冲区技术，基本思路是准备两块buffer：A和B，前端往buffer A填写数据，后端负责把buffer B内容写入文件。当buffer A写满之后交换A和B，让后端负责将buffer A中数据写入文件，而前端则往buffer B中填入新的日志消息，如此反复。用两个buffer的好处是：在新建日志消息的时候不必等待磁盘文件操作，也避免每条日志消息都触发后端日志线程。换言之前端不是将一条条日志消息分别传送给后端而是将多条日志消息拼成一个大的buffer传送给后端，相当于批处理，减少了线程唤醒的频度，降低了开销。另外为了及时将日志消息写入文件，即便buffer A没有满，日志库也会每3秒执行一次上述交换写入操作。
## 核心类
1.FixedBuffer类
功能：封装一个缓冲区，内部数据结构是一个char类型的数组，大小可变。
数据成员：
	- 外部数据成员：无
	- 内部数据成员：char data_[SIZE]、char* cur_
函数成员：
	- 外部函数成员：对data_数组的操作函数（add()、avail()、bzero()等）
	- 内部函数成员：char* end()
2.LogStream类<br>
功能：自己实现一个输入流。
数据成员：
	- 外部数据成员：无
	- 内部数据成员：FixedBuffer类对象（4000比特）
函数成员：
	- 外部函数成员：void formatInteger(T)
	- 内部函数成员：重载"<<"运算符
3.Logger类
功能：用来产生日志信息，并输出。
数据成员：
	- 外部数据成员：无
	- 内部数据成员：类成员Impl(公有成员含有stream_对象、basename_、line_、void formatTime()函数，用来在构造函数中产生时间信息，在析构函数中产生文件名、行数等信息)
函数成员：
	- 外部函数成员：LogStream& stream()可以返回stream_对象
	- 内部函数成员：无
4.LogFile类
功能：负责将日志信息写入到文件当中的类。
数据成员：
	- 外部数据成员：无
	- 内部数据成员：basename_、flushEveryN_、count_、unique_ptr<MutexLock> mutex_、unique_ptr<AppendFile> file_
函数成员：
	- 外部函数成员：append()和flush()这两个函数通过file_指针调用AppendFile类中的append()和flush()函数。
	- 内部函数成员：append_unlocked()
5.AppendFile类
功能：打开一个文件，建立文件的缓冲，然后对文件进行追加内容等操作。
数据成员：
	- 外部数据成员：无
	- 内部数据成员：fp_文件指针、char buffer_[64*1024]是fp_的缓冲区
函数成员：
	- 外部函数成员：append()和flush()
	- 内部函数成员：size_t write()往文件中写数据
6.AsyncLogging类
功能：启动一个专门的日志线程，可以将各个线程产生的小buffer整理成大的buffer块，并将大的buffer块存入文件。
数据成员：
	- 外部数据成员：无
	- 内部数据成员：currentBuffer_、nextBuffer_、buffers_数组、条件变量、锁、thread_、basename_
函数成员：
	- 外部函数成员：append(const char* logline, int len)、void start()、void stop()
	- 内部函数成员：threadFunc()